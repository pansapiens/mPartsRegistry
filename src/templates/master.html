<html>
<head>
<title>mPartsRegistry</title>
<script type="text/javascript" src="http://www.google.com/jsapi"></script>
<script type="text/javascript"> google.load("jquery", "1.3.2"); </script>
<script src="/js/jqtouch.min.js" type="application/x-javascript" charset="utf-8"></script>
<style type="text/css" media="screen">@import "/css/jqtouch.min.css";</style>
<style type="text/css" media="screen">@import "/themes/jqt/theme.css";</style>

<script type="text/javascript">

Storage.prototype.setObject = function(key, value) {
    this.setItem(key, JSON.stringify(value));
}
 
Storage.prototype.getObject = function(key) {
    return JSON.parse(this.getItem(key));
}

favs = localStorage.getObject("favorites");
//create an empty array if we have no favorites stored
if (favs == null) {
	  favs = [];
}

function toggleFavorite(id) {

	  var removed = false;
	  for (var i = 0; i < favs.length; i++) {
	   if (favs[i] == id) {
	     favs.splice(i, 1);
	     removed = true;
	     $('#favorite').html("Add to favorites");
	   }
	  }
	  if (!removed) {
	     favs.push(id);
	     $('#favorite').html("Remove from favorites");
	  }
	  localStorage.setObject("favorites", favs);
}

function checkFavorite(id) {
	  for (var i = 0; i < favs.length; i++) {
	   if (favs[i] == id) {
	     return true;
	   }
	  }
	  return false;
}

$.jQTouch({
    icon: 'jqtouch.png',
    statusBar: 'black-translucent',
    preloadImages: [
	  '/themes/jqt/img/back_button_clicked.png',
	  '/themes/jqt/img/chevron_circle.png',
	  '/themes/jqt/img/on_off.png',
	  '/themes/jqt/img/toolbar.png',
	  '/themes/jqt/img/back_button.png',
	  '/themes/jqt/img/chevron.png',
	  '/themes/jqt/img/rowhead.png',
	  '/themes/jqt/img/whiteButton.png',
	  '/themes/jqt/img/blueButton.png',
	  '/themes/jqt/img/button_clicked.png',
	  '/themes/jqt/img/grayButton.png',
	  '/themes/jqt/img/toggleOn.png',
	  '/themes/jqt/img/button.png',
	  '/themes/jqt/img/loading.gif',
	  '/themes/jqt/img/toggle.png',
    ]
});

/*
$(function(){
	$('#part').bind('pageAnimationEnd', function(e, info){
		if ( checkFavorite('{{ part_name }}') ) {
			 $(this).find('#favorite').html("Remove from favorites");
			}
			else {
				$(this).find('#favorite').html("Add to favorites");
			}
	});
});
*/
</script>

{% block head %}{% endblock %}

</head>

<body class="portrait">
{% block body %}{% endblock %}
</body>
</html>